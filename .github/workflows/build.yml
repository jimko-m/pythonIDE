name: Build APK

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      ANDROID_COMPILE_SDK: 33
      ANDROID_BUILD_TOOLS: 33.0.0
      ANDROID_TARGET_SDK: 33
      ANDROID_ABIS: arm64-v8a,armeabi-v7a

    steps:
      # 1️⃣ تحميل المشروع
      - name: Checkout project
        uses: actions/checkout@v3

      # 2️⃣ إعداد Java 17
      - name: Setup Java 17
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: '17'

      # 3️⃣ إعداد Android SDK
      - name: Setup Android SDK
        uses: android-actions/setup-android@v3
        with:
          cmdline-tools-version: 12266719
          accept-android-sdk-licenses: true
          log-accepted-android-sdk-licenses: true
          packages: tools platform-tools build-tools;33.0.0 platforms;android-33

      # 4️⃣ تثبيت dependencies إذا كان مشروعك يستخدم Gradle
      - name: Build APK
        run: ./gradlew assembleRelease
